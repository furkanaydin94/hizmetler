<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hizmet Kartlarƒ± - Kurumsal Geli≈üim Portal</title>

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Design System -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/wizard.css">
    <link rel="stylesheet" href="css/gallery.css">

    <!-- Libraries -->
    <script src="libs/xlsx.full.min.js"></script>

    <style>
        /* Hiyerar≈üik Filtre Stilleri */
        .filter-layout {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .hierarchical-filter {
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
        }

        .filter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.25rem;
            background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%);
            color: white;
        }

        .filter-header h3 {
            font-size: 14px;
            font-weight: 600;
            margin: 0;
        }

        .filter-header .filter-stats {
            font-size: 12px;
            opacity: 0.8;
        }

        .filter-content {
            max-height: 55vh;
            overflow-y: auto;
            padding: 0.5rem;
        }

        /* M√ºd√ºrl√ºk Item */
        .mudurluk-item {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            overflow: hidden;
        }

        .mudurluk-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            background: #f8fafc;
            cursor: pointer;
            transition: background 0.2s;
        }

        .mudurluk-header:hover {
            background: #f1f5f9;
        }

        .mudurluk-header .expand-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
            color: #64748b;
        }

        .mudurluk-item.expanded .mudurluk-header .expand-icon {
            transform: rotate(90deg);
        }

        .mudurluk-header .mudurluk-checkbox {
            width: 18px;
            height: 18px;
            accent-color: #1e3a5f;
        }

        .mudurluk-header .mudurluk-name {
            flex: 1;
            font-weight: 600;
            font-size: 14px;
            color: #1e293b;
        }

        .mudurluk-header .mudurluk-count {
            font-size: 12px;
            color: #64748b;
            background: #e2e8f0;
            padding: 2px 8px;
            border-radius: 10px;
        }

        /* Hizmet Container */
        .hizmet-container {
            display: none;
            padding: 0.5rem 0.5rem 0.5rem 2.5rem;
            background: #fff;
        }

        .mudurluk-item.expanded .hizmet-container {
            display: block;
        }

        /* Hizmet Item */
        .hizmet-item {
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            margin-bottom: 0.35rem;
            overflow: hidden;
        }

        .hizmet-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            cursor: pointer;
            transition: background 0.2s;
        }

        .hizmet-header:hover {
            background: #f8fafc;
        }

        .hizmet-header .expand-icon {
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
            color: #94a3b8;
        }

        .hizmet-item.expanded .hizmet-header .expand-icon {
            transform: rotate(90deg);
        }

        .hizmet-header .hizmet-checkbox {
            width: 16px;
            height: 16px;
            accent-color: #2563eb;
        }

        .hizmet-header .hizmet-name {
            flex: 1;
            font-size: 13px;
            color: #334155;
        }

        .hizmet-header .hizmet-count {
            font-size: 11px;
            color: #94a3b8;
        }

        /* T√ºr Container */
        .tur-container {
            display: none;
            padding: 0.35rem 0.5rem 0.5rem 2rem;
            background: #fafafa;
        }

        .hizmet-item.expanded .tur-container {
            display: block;
        }

        /* T√ºr Item */
        .tur-item-inline {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.35rem 0.5rem;
            border-radius: 4px;
            transition: background 0.15s;
        }

        .tur-item-inline:hover {
            background: #f1f5f9;
        }

        .tur-item-inline input {
            width: 14px;
            height: 14px;
            accent-color: #059669;
        }

        .tur-item-inline label {
            font-size: 12px;
            color: #475569;
            cursor: pointer;
        }

        /* Yardƒ±mcƒ± T√ºr Aracƒ± */
        .helper-tool {
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
        }

        .helper-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.25rem;
            background: #f1f5f9;
            border-bottom: 1px solid #e2e8f0;
        }

        .helper-header h3 {
            font-size: 14px;
            font-weight: 600;
            color: #475569;
            margin: 0;
        }

        .helper-header .btn-sm {
            font-size: 12px;
            padding: 4px 10px;
        }

        .helper-content {
            padding: 1rem;
            max-height: 50vh;
            overflow-y: auto;
        }

        .helper-description {
            font-size: 12px;
            color: #64748b;
            margin-bottom: 1rem;
            padding: 0.75rem;
            background: #f8fafc;
            border-radius: 6px;
            border-left: 3px solid #94a3b8;
        }

        .tur-pills {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .tur-pill {
            display: flex;
            align-items: center;
            gap: 0.35rem;
            padding: 6px 12px;
            background: #e2e8f0;
            border: 1px solid #cbd5e1;
            border-radius: 20px;
            font-size: 12px;
            color: #475569;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tur-pill.active {
            background: #1e3a5f;
            border-color: #1e3a5f;
            color: white;
        }

        .tur-pill:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* Summary stats */
        .filter-summary {
            padding: 1rem 1.25rem;
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .filter-summary .summary-text {
            font-size: 13px;
            color: #475569;
        }

        .filter-summary .summary-counts {
            display: flex;
            gap: 1rem;
        }

        .filter-summary .count-item {
            font-size: 12px;
            color: #64748b;
        }

        .filter-summary .count-item strong {
            color: #1e3a5f;
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="page-header">
        <div class="header-content">
            <div class="brand">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                <span>Hizmet Kartlarƒ±</span>
            </div>
            <div class="header-actions">
                <a href="index.html" class="btn-header">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                    Ana Sayfa
                </a>
            </div>
        </div>
    </header>

    <!-- Inline script to prevent wizard flash when autoGenerate mode -->
    <script>
        (function () {
            // URL veya localStorage'dan autoGenerate kontrol√º
            var urlAutoGen = new URLSearchParams(window.location.search).get('autoGenerate') === 'true';
            var localAutoGen = localStorage.getItem('gallery_auto_generate') === 'true';
            if (urlAutoGen || localAutoGen) {
                document.write('<style id="auto-generate-style">#wizard-container{display:none!important}#gallery-container{display:block!important}</style>');
            }
        })();
    </script>

    <!-- Wizard Container -->
    <div class="wizard-container" id="wizard-container">

        <!-- Filtre Se√ßimi (Tek step - doƒürudan a√ßƒ±lƒ±yor) -->
        <div class="wizard-step wide active" id="step-customize">
            <div class="step-card wide">
                <div class="step-header-inline">
                    <div>
                        <h2 class="step-title">Rapor Filtresi</h2>
                        <p class="step-description">Raporlara dahil edilecek m√ºd√ºrl√ºk, hizmet ve t√ºrleri se√ßin</p>
                    </div>
                </div>

                <!-- Rapor Tarihi Se√ßimi -->
                <div class="report-date-section"
                    style="margin-bottom: 1.5rem; padding: 1rem; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px;">
                    <div style="display: flex; align-items: center; gap: 1rem; flex-wrap: wrap;">
                        <label style="font-weight: 600; color: #1e293b; font-size: 14px;">üìÖ Rapor Tarihi:</label>
                        <input type="month" id="report-month"
                            style="padding: 8px 12px; border: 1px solid #cbd5e1; border-radius: 6px; font-family: inherit; font-size: 14px;">
                        <span style="font-size: 12px; color: #64748b;">Se√ßilen ayƒ±n verileri kullanƒ±lacak</span>
                    </div>
                </div>

                <!-- Hiyerar≈üik Filtre Yapƒ±sƒ± -->
                <div class="filter-layout">
                    <!-- Sol: Ana Hiyerar≈üik Filtre -->
                    <div class="hierarchical-filter">
                        <div class="filter-header">
                            <h3>M√ºd√ºrl√ºk ‚Üí Hizmet ‚Üí T√ºr</h3>
                            <span class="filter-stats" id="filter-stats">Y√ºkleniyor...</span>
                        </div>
                        <div class="filter-content" id="hierarchical-list">
                            <div style="text-align: center; padding: 2rem; color: #94a3b8;">
                                <div class="spinner"></div>
                                <p>Veriler y√ºkleniyor...</p>
                            </div>
                        </div>
                        <div class="filter-summary">
                            <span class="summary-text">Se√ßili √∂ƒüeler:</span>
                            <div class="summary-counts">
                                <span class="count-item"><strong id="selected-mudurluk-count">0</strong> m√ºd√ºrl√ºk</span>
                                <span class="count-item"><strong id="selected-hizmet-count">0</strong> hizmet</span>
                                <span class="count-item"><strong id="selected-tur-count">0</strong> t√ºr</span>
                            </div>
                        </div>
                    </div>

                    <!-- Saƒü: Yardƒ±mcƒ± T√ºr Aracƒ± -->
                    <div class="helper-tool">
                        <div class="helper-header">
                            <h3>T√ºr Kƒ±sayollarƒ±</h3>
                            <button class="btn btn-ghost btn-sm" id="btn-select-all-turler">T√ºm√ºn√º Se√ß</button>
                        </div>
                        <div class="helper-content">
                            <div class="helper-description" style="background: #f8fafc; border-left-color: #94a3b8;">
                                Buradan bir t√ºre tƒ±klayarak o t√ºr√º <strong>t√ºm hizmetlerde</strong> toplu olarak
                                se√ßebilir veya kaldƒ±rabilirsiniz.
                            </div>
                            <div class="tur-pills" id="tur-pills">
                                <div style="color: #94a3b8;">Y√ºkleniyor...</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="step-actions" style="margin-top: 1.5rem;">
                    <div class="step-actions-row">
                        <button class="btn btn-primary" id="btn-create-reports">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <rect x="3" y="3" width="7" height="7"></rect>
                                <rect x="14" y="3" width="7" height="7"></rect>
                                <rect x="14" y="14" width="7" height="7"></rect>
                                <rect x="3" y="14" width="7" height="7"></rect>
                            </svg>
                            Raporlarƒ± Olu≈ütur
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Gallery Container (Initially Hidden) -->
    <div class="gallery-container" id="gallery-container" style="display: none;">
        <main class="gallery-content">
            <div class="content-header">
                <div class="header-info">
                    <h2>Rapor Galerisi</h2>
                    <p id="gallery-stats">Lokasyonlar y√ºkleniyor...</p>
                </div>
                <button class="btn btn-secondary" id="btn-back-to-wizard">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg>
                    Ayarlarƒ± Deƒüi≈ütir
                </button>
            </div>

            <!-- Gallery Grid -->
            <div class="report-gallery" id="report-gallery">
                <div class="gallery-loading">
                    <div class="spinner"></div>
                    <p>Raporlar hazƒ±rlanƒ±yor...</p>
                </div>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="js/gallery.js"></script>
</body>

</html>